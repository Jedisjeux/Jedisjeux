{% from 'backend/macros/sorting.html.twig' import sorting %}
{% import 'SyliusUiBundle:Macro:buttons.html.twig' as button %}
{% from 'macros/images.html.twig' import image %}
{% from 'macros/users.html.twig' import avatar %}

{% set defaultSorting = app.request.get('sorting') ? false : true %}
{% set defaultOrder = 'desc' %}
{% set currentOrder = defaultSorting ? defaultOrder : app.request.get('sorting') %}

<table class="ui celled table">
    <thead>
    <tr>
        <th>{{ 'app.ui.avatar'|trans }}</th>
        <th>{{ sorting('app_backend_topic_index', 'sylius.ui.username'|trans, 'user.username', 'asc') }}</th>
        <th>{{ sorting('app_backend_topic_index', 'app.ui.name'|trans, 'name', 'asc') }}</th>
        <th>{{ sorting('app_backend_topic_index', 'sylius.ui.created_at'|trans, 'createdAt', 'desc', true, currentOrder) }}</th>
        <th>{{ 'sylius.ui.actions'|trans }}</th>
    </tr>
    </thead>
    <tbody>
    {% for topic in topics %}
        {% set user = topic.author.user %}
        <tr>
            <td>{{ image(avatar(user), 'thumbnail', user.customer, 'ui circular image') }}</td>
            <td>{{ user }}</td>
            <td>{{ topic.title }}</td>
            <td>{{ topic.createdAt|localizeddate('medium', 'none') }}</td>
            <td>
                <div class="ui buttons">
                    {{ button.edit(path('app_backend_topic_update', { 'id': topic.id } )) }}
                    {{ button.delete(path('app_backend_topic_delete', { 'id': topic.id } )) }}
                </div>
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>