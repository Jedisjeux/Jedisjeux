sylius_product_review_create:
    path: /products/{productId}/reviews/new
    methods: [GET, POST]
    defaults:
        _controller: sylius.controller.product_review:createAction
        _sylius:
            template: 'frontend/product_review/_form.html.twig'
            factory:
                method: createForSubject
                arguments: [$productId]

sylius_product_rating_create:
    path: /products/{productId}/rating/new
    methods: [GET, POST]
    defaults:
        _format: json
        _controller: sylius.controller.product_review:createAction
        _sylius:
            template: 'frontend/product_review/rating/_form.html.twig'
            form: sylius_product_review_rating
            factory:
                method: createForSubject
                arguments: [$productId]
    options:
        expose: true

sylius_product_rating_update:
    path: /products/{productId}/rating/edit
    methods: [GET, PUT, PATCH]
    defaults:
        _controller: sylius.controller.product_review:updateAction
        _format: json
        _sylius:
            template: 'frontend/product_review/rating/_form.html.twig'
            form: sylius_product_review_rating
            repository:
                method: findOneBy
                arguments: [{reviewSubject: $productId, author: expr:service('app.context.customer').getCustomer()}]
    options:
        expose: true