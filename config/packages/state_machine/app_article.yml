winzou_state_machine:
    app_article:
        class: '%app.model.article.class%'
        property_path: status
        graph: app_article
        state_machine_class: '%sylius.state_machine.class%'
        states:
            new: ~
            pending_review: ~
            pending_publication: ~
            published: ~
        transitions:
            ask_for_review:
                from: [new]
                to: pending_review
            ask_for_publication:
                from: [pending_review]
                to: pending_publication
            publish:
                from: [pending_publication]
                to: published
        callbacks:
            guard:
                guard_on_ask_for_publication:
                    on: 'ask_for_publication'
                    do: ['@app.guard.article', 'canAskForPublication']
                    args: []
                guard_on_publish:
                    on: 'publish'
                    do: ['@app.guard.article', 'canPublish']
                    args: []
            after:
                notify_reviewers:
                    on: 'ask_for_review'
                    do: ['@App\NotificationManager\ArticleNotificationManager', 'notifyReviewers']
                    args: ['object']
                notify_publishers:
                    on: 'ask_for_publication'
                    do: ['@App\NotificationManager\ArticleNotificationManager', 'notifyPublishers']
                    args: ['object']
                notify_subscribers:
                    on: 'publish'
                    do: ['@App\NotificationManager\ArticleNotificationManager', 'notifySubscribers']
                    args: ['object']
                start:
                    on: 'publish'
                    do: ['@app.publication_manager.article', 'start']
                    args: ['object']
                dump_feed:
                    on: 'publish'
                    do: ['@app.feed.dump.article', 'dump']
